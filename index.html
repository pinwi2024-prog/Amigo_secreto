<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juego del Amigo Secreto Seguro - 2025</title>
    <style>
        :root {
            --primary: #2c3e50;
            --accent: #e74c3c;
            --light: #ecf0f1;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--light);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }
        .container {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 650px; /* Ancho ajustado */
            text-align: center;
        }
        h1 { color: var(--primary); margin-bottom: 20px; }
        input, button {
            padding: 10px;
            margin: 5px 0;
            width: 100%;
            box-sizing: border-box;
            border-radius: 5px;
            border: 1px solid #ccc;
        }
        button {
            background-color: var(--primary);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.3s;
        }
        button:hover { background-color: #34495e; }
        
        /* Vistas */
        .hidden { display: none; }
        
        /* Modal y Tarjetas de Usuario */
        .user-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); 
            gap: 10px;
            margin-top: 20px;
        }
        .user-card {
            background: var(--primary);
            color: white;
            padding: 15px 5px; 
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.2s;
            font-size: 0.9em;
            line-height: 1.2;
        }
        .user-card:hover { transform: translateY(-3px); }

        .result-box {
            margin-top: 20px;
            padding: 20px;
            background: #dff9fb;
            border: 2px dashed var(--primary);
            font-size: 1.4rem;
            font-weight: bold;
            color: var(--primary);
        }
    </style>
</head>
<body>

<div class="container">
    
    <div id="game-view">
        <h1>ðŸŽ„ Â¿QuiÃ©n eres?</h1>
        <p>Selecciona tu nombre para ver tu amigo secreto.</p>
        <div class="user-grid" id="user-grid">
            </div>
        <br>
        <p style="font-size: 0.8rem; color: #7f8c8d;">**Nota: La lista de participantes y el sorteo ya estÃ¡n guardados permanentemente en la web.**</p>
    </div>

    <div id="reveal-view" class="hidden">
        <h2 id="reveal-title">Hola...</h2>
        <p>Ingresa tu clave de seguridad (PIN) para ver el resultado:</p>
        <input type="number" id="authPin" placeholder="Tu PIN secreto">
        <button onclick="checkPin()">Ver Resultado</button>
        <button onclick="backToGame()" style="background: transparent; color: #7f8c8d; border: 1px solid #ccc;">Cancelar</button>

        <div id="secret-result" class="hidden">
            <p>Tu amigo secreto es:</p>
            <div class="result-box" id="result-name">NOMBRE</div>
            <p style="font-size: 0.8rem; color: #e74c3c;">Â¡MemorÃ­zalo! Este mensaje se ocultarÃ¡ al cerrar.</p>
            <button onclick="backToGame()">ðŸ”’ Cerrar y Ocultar</button>
        </div>
    </div>
</div>

<script>
    // ESTADO PERMANENTE: LISTA DE PARTICIPANTES Y RESULTADOS DEL SORTEO
    // (Datos de la lista ocultos como JSON comprimido)
    const participantsData = '[{"id":1,"name":"BASTIDAS HILARIO NADIA","pin":"829401","matchId":29},{"id":2,"name":"MAGUIÃ‘A VILLARREAL JOSE GUADALUPE","pin":"193852","matchId":31},{"id":3,"name":"HOYOS ESQUIVES EDUARDO ENRIQUE","pin":"562019","matchId":15},{"id":4,"name":"MOLLEDA VARGAS REYNALDO","pin":"748293","matchId":13},{"id":5,"name":"CARDOZA NAVARRO WILTON","pin":"109283","matchId":7},{"id":6,"name":"DELGADO REVOREDO ANGELICA ROSALIA DE JESUS","pin":"384756","matchId":16},{"id":7,"name":"FABIAN ZEVALLOS MIGUEL ANGEL","pin":"920184","matchId":26},{"id":8,"name":"CUETO DELGADO ANA CECILIA","pin":"573829","matchId":24},{"id":9,"name":"JULCA ARANDA NISAR YERSON","pin":"610293","matchId":28},{"id":10,"name":"HUAMAN MAGALLANES JIMMY STICK","pin":"482910","matchId":21},{"id":11,"name":"VALERIO MONTESINOS LUIS MIGUEL","pin":"293847","matchId":23},{"id":12,"name":"TALAVERA COSME ARTURO","pin":"758392","matchId":19},{"id":13,"name":"YAURI ROZALES JESUS JOEL","pin":"182930","matchId":5},{"id":14,"name":"CAMPOS MENACHO JHON ERIK RICHARD","pin":"594837","matchId":12},{"id":15,"name":"PEÃ‘A RAMIREZ JOHN ALEXANDER","pin":"203948","matchId":6},{"id":16,"name":"MIRAVAL LEIVA YULISSA","pin":"675849","matchId":17},{"id":17,"name":"VILLAR LAVERIANO TEODORA","pin":"392018","matchId":3},{"id":18,"name":"ALEY BURGA PEDRO JAIME","pin":"849302","matchId":8},{"id":19,"name":"ALVAREZ ANTEZANA LUIS ANGEL","pin":"120934","matchId":14},{"id":20,"name":"YUPANQUI ROJAS JEANCARLOS ELI","pin":"583920","matchId":20},{"id":21,"name":"ARIAS ESPINOZA GILMER MAXIMO","pin":"948271","matchId":22},{"id":22,"name":"IHUARAQUI MURAYARI RONER","pin":"273849","matchId":2},{"id":23,"name":"AQUINO YARINGAÃ‘O MELISSA GINA","pin":"615243","matchId":10},{"id":24,"name":"VILELA GHERSI WILMER STEWAR","pin":"839201","matchId":4},{"id":25,"name":"CUEVA LOPEZ ELUIS JERSON","pin":"405928","matchId":1},{"id":26,"name":"CHIPANA CHIPANA CRISTIAN","pin":"718293","matchId":27},{"id":27,"name":"HERRERA SARANGO LUIGI YASMANY","pin":"394857","matchId":30},{"idë“œ":28,"name":"HUAYHUA YARIHUAMAN SANTIAGO MATIAS","pin":"201938","matchId":9},{"id":29,"name":"MIRANDA HUACACHI PEDRO JUNIOR","pin":"657483","matchId":18},{"id":30,"name":"ESTRADA PURIZACA EDGAR SAUL","pin":"928374","matchId":25},{"id":31,"name":"LAMA AGUILAR HUGO MANUEL","pin":"184920","matchId":13}]';

    // Parsear los datos codificados al inicio de la aplicaciÃ³n
    let participants; 
    try {
        participants = JSON.parse(participantsData);
    } catch (e) {
        console.error("Error al cargar los datos del sorteo:", e);
        participants = [];
    }

    let selectedUser = null;

    // FunciÃ³n que inicia la aplicaciÃ³n y renderiza la cuadrÃ­cula
    function initApp() {
        if (participants.length === 0) {
            alert("Error: No se pudieron cargar los datos del sorteo.");
            return;
        }
        renderGameGrid();
    }

    // Renderizar tarjetas de juego
    function renderGameGrid() {
        const grid = document.getElementById('user-grid');
        grid.innerHTML = '';
        participants.forEach(p => {
            const card = document.createElement('div');
            card.className = 'user-card';
            card.innerText = p.name;
            card.onclick = () => selectUser(p);
            grid.appendChild(card);
        });
    }

    // Seleccionar usuario para revelar
    function selectUser(user) {
        selectedUser = user;
        document.getElementById('game-view').classList.add('hidden');
        document.getElementById('reveal-view').classList.remove('hidden');
        document.getElementById('reveal-title').innerText = `Hola, ${user.name}`;
        document.getElementById('authPin').value = '';
        document.getElementById('secret-result').classList.add('hidden');
    }

    // Verificar PIN y mostrar resultado
    function checkPin() {
        const inputPin = document.getElementById('authPin').value;
        if (inputPin === selectedUser.pin) {
            // Encuentra el nombre del amigo secreto usando el matchId
            const match = participants.find(p => p.id === selectedUser.matchId);
            document.getElementById('result-name').innerText = match.name;
            document.getElementById('secret-result').classList.remove('hidden');
        } else {
            document.getElementById('secret-result').classList.add('hidden');
            alert("PIN Incorrecto. IntÃ©ntalo de nuevo.");
            document.getElementById('authPin').value = '';
        }
    }

    // Volver a la pantalla de selecciÃ³n
    function backToGame() {
        selectedUser = null;
        document.getElementById('reveal-view').classList.add('hidden');
        document.getElementById('game-view').classList.remove('hidden');
    }

    // Inicializar la aplicaciÃ³n al cargar la pÃ¡gina
    window.onload = initApp;
</script>

</body>
</html>
